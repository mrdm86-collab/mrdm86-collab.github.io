<!DOCTYPE html>
<html lang="zh" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novatra AI 博客管理后台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
        }

        .bg-grid-slate-200 {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='%23e7e5e4'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
        }

        .dark .bg-grid-slate-800 {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='%23292524'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
        }

        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }

        @keyframes gradient-x {
            0%, 100% {
                background-size: 200% 200%;
                background-position: left center;
            }
            50% {
                background-size: 200% 200%;
                background-position: right center;
            }
        }

        .animate-blob {
            animation: blob 7s infinite;
        }

        .animate-gradient-x {
            animation: gradient-x 15s ease infinite;
        }

        .animation-delay-2000 {
            animation-delay: 2s;
        }

        /* 自定义滚动条 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #14b8a6;
        }
    </style>
</head>
<body class="bg-stone-50 dark:bg-stone-900 min-h-screen text-stone-900 dark:text-stone-100">
    <div class="relative min-h-screen flex items-center justify-center overflow-hidden">
        <!-- 背景效果 -->
        <div class="absolute inset-0 -z-10 pointer-events-none">
            <div class="absolute top-0 left-1/4 w-[500px] h-[500px] md:w-[800px] md:h-[500px] bg-teal-500/10 blur-[80px] md:blur-[120px] rounded-full mix-blend-multiply dark:mix-blend-screen opacity-60 animate-blob"></div>
            <div class="absolute bottom-0 right-1/4 w-[500px] h-[500px] md:w-[800px] md:h-[500px] bg-emerald-500/10 blur-[80px] md:blur-[120px] rounded-full mix-blend-multiply dark:mix-blend-screen opacity-60 animate-blob animation-delay-2000"></div>
            <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 contrast-150 brightness-100"></div>
            <div class="absolute inset-0 bg-grid-slate-200 dark:bg-grid-slate-800/[0.2] bg-[bottom_1px_center]"></div>
        </div>

        <!-- 登录容器 -->
        <div class="w-full max-w-md mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-white/60 dark:bg-stone-900/60 backdrop-blur-md border border-stone-200/60 dark:border-stone-800/60 rounded-2xl p-8 shadow-xl">
                <!-- Logo 和标题 -->
                <div class="text-center mb-8">
                    <!-- Logo SVG -->
                    <div class="flex justify-center mb-6">
                        <svg width="80" height="80" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-20 h-20">
                            <defs>
                                <linearGradient id="tealGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#0d9488"/>
                                    <stop offset="100%" stop-color="#34d399"/>
                                </linearGradient>
                            </defs>
                            <path d="M 150,400 L 150,112 L 362,400 L 362,112"
                                  stroke="url(#tealGradient)"
                                  stroke-width="110"
                                  stroke-linecap="round"
                                  stroke-linejoin="round"/>
                            <circle cx="150" cy="112" r="32" fill="white"/>
                            <circle cx="362" cy="400" r="32" fill="white"/>
                        </svg>
                    </div>

                    <h1 class="text-3xl font-bold text-stone-900 dark:text-white mb-2">
                        欢迎回来
                    </h1>
                    <p class="text-stone-600 dark:text-stone-400">
                        登录 Novatra AI 博客管理后台
                    </p>
                </div>

                <!-- 登录表单 -->
                <div id="login-form">
                    <div class="space-y-6">
                        <!-- GitHub 登录按钮 -->
                        <button onclick="loginWithGitHub()"
                                class="w-full flex items-center justify-center gap-3 px-6 py-3 bg-stone-900 dark:bg-white text-white dark:text-stone-900 font-semibold rounded-xl hover:bg-stone-800 dark:hover:bg-stone-100 transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.605-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"/>
                            </svg>
                            使用 GitHub 登录
                        </button>

                        <!-- 分隔线 -->
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-stone-300 dark:border-stone-700"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white dark:bg-stone-900 text-stone-500">
                                    安全登录方式
                                </span>
                            </div>
                        </div>

                        <!-- 功能说明 -->
                        <div class="text-center space-y-3">
                            <div class="flex items-center justify-center gap-2 text-sm text-stone-600 dark:text-stone-400">
                                <svg class="w-4 h-4 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                与 GitHub 组织权限同步
                            </div>
                            <div class="flex items-center justify-center gap-2 text-sm text-stone-600 dark:text-stone-400">
                                <svg class="w-4 h-4 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                                </svg>
                                安全的 OAuth 认证
                            </div>
                            <div class="flex items-center justify-center gap-2 text-sm text-stone-600 dark:text-stone-400">
                                <svg class="w-4 h-4 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                </svg>
                                自动同步前端博客内容
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 加载状态 -->
                <div id="loading" class="hidden text-center py-8">
                    <div class="inline-flex items-center gap-3">
                        <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-teal-600"></div>
                        <span class="text-stone-600 dark:text-stone-400">正在跳转到 GitHub...</span>
                    </div>
                </div>

                <!-- 错误信息 -->
                <div id="error-message" class="hidden mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm">
                    <!-- 错误信息将在这里显示 -->
                </div>
            </div>

            <!-- 页脚信息 -->
            <div class="text-center mt-8">
                <p class="text-sm text-stone-500 dark:text-stone-500">
                    © 2024 Novatra AI. 构建未来，智能无限。
                </p>
                <div class="mt-2 flex items-center justify-center gap-4">
                    <a href="/" class="text-sm text-teal-600 hover:text-teal-700 dark:text-teal-400 dark:hover:text-teal-300 transition-colors">
                        返回博客首页
                    </a>
                    <span class="text-stone-400">•</span>
                    <a href="https://github.com/Ai-Novatra" target="_blank" class="text-sm text-teal-600 hover:text-teal-700 dark:text-teal-400 dark:hover:text-teal-300 transition-colors">
                        GitHub
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="/admin/js/auth.js"></script>
    <script>
        // GitHub 登录
        function loginWithGitHub() {
            const loginForm = document.getElementById('login-form');
            const loading = document.getElementById('loading');
            const errorMessage = document.getElementById('error-message');

            // 隐藏错误信息
            errorMessage.classList.add('hidden');

            // 显示加载状态
            loginForm.classList.add('hidden');
            loading.classList.remove('hidden');

            // 使用认证管理器启动登录流程
            authManager.login().catch(error => {
                console.error('登录失败:', error);
                showError('登录失败，请重试');
            });
        }

        // 显示错误信息
        function showError(message) {
            const errorMessage = document.getElementById('error-message');
            const loginForm = document.getElementById('login-form');
            const loading = document.getElementById('loading');

            // 隐藏加载状态，显示登录表单
            loading.classList.add('hidden');
            loginForm.classList.remove('hidden');

            // 显示错误信息
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        // 页面加载时检查认证状态
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const error = urlParams.get('error');

            if (error) {
                showError('登录失败，请重试');
                // 清除 URL 参数
                window.history.replaceState({}, document.title, window.location.pathname);
            } else {
                // 检查是否已登录
                await checkAuthStatus();
            }
        });

        // 主题切换功能
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        }

        // 初始化主题
        if (localStorage.getItem('theme') === 'light' ||
            (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: light)').matches)) {
            document.documentElement.classList.remove('dark');
        }
    </script>
</body>
</html>